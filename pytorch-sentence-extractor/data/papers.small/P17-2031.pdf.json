{
    "abstract_sentences": {
        "1": "Modeling attention in neural multi-source sequence-to-sequence learning remains a relatively unexplored area, despite its usefulness in tasks that incorporate multiple source languages or modalities.", 
        "2": "We propose two novel approaches to combine the outputs of attention mechanisms over each source sequence, flat and hierarchical.", 
        "3": "We compare the proposed methods with existing techniques and present results of systematic evaluation of those methods on the WMT16 Multimodal Translation and Automatic Post-editing tasks.", 
        "4": "We show that the proposed methods achieve competitive results on both tasks."
    }, 
    "body_sentences": {
        "1": "  Proceedings of the 55th Annual Meeting of the Association for Computational Linguistics (Short Papers), pages 196\u2013202 Vancouver, Canada, July 30 - August 4, 2017. c\u00a92017 Association for Computational Linguistics\nhttps://doi.org/10.18653/v1/P17-2031  1 Introduction  Sequence-to-sequence (S2S) learning with attention mechanism recently became the most successful paradigm with state-of-the-art results in machine translation (MT) (Bahdanau et al., 2014; Sennrich et al., 2016a), image captioning (Xu et al., 2015; Lu et al., 2016), text summarization (Rush et al., 2015) and other NLP tasks.", 
        "2": "All of the above applications of S2S learning make use of a single encoder.", 
        "3": "Depending on the modality, it can be either a recurrent neural network (RNN) for textual input data, or a convolutional network for images.", 
        "4": "In this work, we focus on a special case of S2S learning with multiple input sequences of possibly different modalities and a single output-generating recurrent decoder.", 
        "5": "We explore various strategies the decoder can employ to attend to the hidden states of the individual encoders.", 
        "6": "The existing approaches to this problem do not explicitly model different importance of the inputs to the decoder (Firat et al., 2016; Zoph and Knight,\n2016).", 
        "7": "In multimodal MT (MMT), where an image and its caption are on the input, we might expect the caption to be the primary source of information, whereas the image itself would only play a role in output disambiguation.", 
        "8": "In automatic post-editing (APE), where a sentence in a source language and its automatically generated translation are on the input, we might want to attend to the source text only in case the model decides that there is an error in the translation.", 
        "9": "We propose two interpretable attention strategies that take into account the roles of the individual source sequences explicitly\u2014flat and hierarchical attention combination.", 
        "10": "This paper is organized as follows: In Section 2, we review the attention mechanism in single-source S2S learning.", 
        "11": "Section 3 introduces new attention combination strategies.", 
        "12": "In Section 4, we evaluate the proposed models on the MMT and APE tasks.", 
        "13": "We summarize the related work in Section 5, and conclude in Section 6.", 
        "14": "2 Attentive S2S Learning  The attention mechanism in S2S learning allows an RNN decoder to directly access information about the input each time before it emits a symbol.", 
        "15": "Inspired by content-based addressing in Neural Turing Machines (Graves et al., 2014), the attention mechanism estimates a probability distribution over the encoder hidden states in each decoding step.", 
        "16": "This distribution is used for computing the context vector\u2014the weighted average of the encoder hidden states\u2014as an additional input to the decoder.", 
        "17": "The standard attention model as described by Bahdanau et al.", 
        "18": "(2014) defines the attention energies eij , attention distribution \u03b1ij , and the con-\n196\ntext vector ci in i-th decoder step as:\neij = v > a tanh(Wasi + Uahj), (1)\n\u03b1ij = exp(eij)\u2211Tx k=1 exp(eik) , (2)\nci =\nTx\u2211\nj=1\n\u03b1ijhj .", 
        "19": "(3)\nThe trainable parameters Wa and Ua are projection matrices that transform the decoder and encoder states si and hj into a common vector space and va is a weight vector over the dimensions of this space.", 
        "20": "Tx denotes the length of the input sequence.", 
        "21": "For the sake of clarity, bias terms (applied every time a vector is linearly projected using a weight matrix) are omitted.", 
        "22": "Recently, Lu et al.", 
        "23": "(2016) introduced sentinel gate, an extension of the attentive RNN decoder with LSTM units (Hochreiter and Schmidhuber, 1997).", 
        "24": "We adapt the extension for gated recurrent units (GRU) (Cho et al., 2014), which we use in our experiments:\n\u03c8i = \u03c3(Wyyi +Wssi\u22121) (4)\nwhere Wy and Ws are trainable parameters, yi is the embedded decoder input, and si\u22121 is the previous decoder state.", 
        "25": "Analogically to Equation 1, we compute a scalar energy term for the sentinel:\ne\u03c8i = v > a tanh ( Wasi + U (\u03c8) a (\u03c8i si) ) (5)\nwhere Wa, U (\u03c8) a are the projection matrices, va is the weight vector, and \u03c8i si is the sentinel vector.", 
        "26": "Note that the sentinel energy term does not depend on any hidden state of any encoder.", 
        "27": "The sentinel vector is projected to the same vector space as the encoder state hj in Equation 1.", 
        "28": "The term e\u03c8i is added as an extra attention energy term to Equation 2 and the sentinel vector \u03c8i si is used as the corresponding vector in the summation in Equation 3.", 
        "29": "This technique should allow the decoder to choose whether to attend to the encoder or to focus on its own state and act more like a language model.", 
        "30": "This can be beneficial if the encoder does not contain much relevant information for the current decoding step.", 
        "31": "3 Attention Combination  In S2S models with multiple encoders, the decoder needs to be able to combine the attention information collected from the encoders.", 
        "32": "A widely adopted technique for combining multiple attention models in a decoder is concatenation of the context vectors c(1)i , .", 
        "33": ".", 
        "34": ".", 
        "35": ", c (N) i (Zoph and Knight, 2016; Firat et al., 2016).", 
        "36": "As mentioned in Section 1, this setting forces the model to attend to each encoder independently and lets the attention combination to be resolved implicitly in the subsequent network layers.", 
        "37": "In this section, we propose two alternative strategies of combining attentions from multiple encoders.", 
        "38": "We either let the decoder learn the \u03b1i distribution jointly over all encoder hidden states (flat attention combination) or factorize the distribution over individual encoders (hierarchical combination).", 
        "39": "Both of the alternatives allow us to explicitly compute distribution over the encoders and thus interpret how much attention is paid to each encoder at every decoding step.", 
        "40": "3.1 Flat Attention Combination  Flat attention combination projects the hidden states of all encoders into a shared space and then computes an arbitrary distribution over the projections.", 
        "41": "The difference between the concatenation of the context vectors and the flat attention combination is that the \u03b1i coefficients are computed jointly for all encoders:\n\u03b1 (k) ij =\nexp(e (k) ij )\n\u2211N n=1 \u2211T (n)x m=1 exp ( e (n) im ) (6)\nwhere T (n)x is the length of the input sequence of the n-th encoder and e(k)ij is the attention energy of the j-th state of the k-th encoder in the i-th decoding step.", 
        "42": "These attention energies are computed as in Equation 1.", 
        "43": "The parameters va andWa are shared among the encoders, and Ua is different for each encoder and serves as an encoder-specific projection of hidden states into a common vector space.", 
        "44": "The states of the individual encoders occupy different vector spaces and can have a different dimensionality, therefore the context vector cannot be computed as their weighted sum.", 
        "45": "We project\nthem into a single space using linear projections:\nci = N\u2211\nk=1\nT (k) x\u2211\nj=1\n\u03b1 (k) ij U (k) c h (k) j (7)\nwhere U (k)c are additional trainable parameters.", 
        "46": "The matrices U (k)c project the hidden states into a common vector space.", 
        "47": "This raises a question whether this space can be the same as the one that is projected into in the energy computation using matrices U (k)a in Equation 1, i.e., whether U (k) c = U (k) a .", 
        "48": "In our experiments, we explore both options.", 
        "49": "We also try both adding and not adding the sentinel \u03b1(\u03c8)i U (\u03c8) c (\u03c8i si) to the context vector.", 
        "50": "3.2 Hierarchical Attention Combination  The hierarchical attention combination model computes every context vector independently, similarly to the concatenation approach.", 
        "51": "Instead of concatenation, a second attention mechanism is constructed over the context vectors.", 
        "52": "We divide the computation of the attention distribution into two steps: First, we compute the context vector for each encoder independently using Equation 3.", 
        "53": "Second, we project the context vectors (and optionally the sentinel) into a common space (Equation 8), we compute another distribution over the projected context vectors (Equation 9) and their corresponding weighted average (Equation 10):\ne (k) i = v > b tanh(Wbsi + U (k) b c (k) i ), (8)\n\u03b2 (k) i = exp(e (k) i )\u2211N\nn=1 exp(e (n) i )\n, (9)\nci = N\u2211\nk=1\n\u03b2 (k) i U (k) c c (k) i (10)\nwhere c(k)i is the context vector of the k-th encoder, additional trainable parameters vb and Wb are shared for all encoders, and U (k)b and U (k) c are encoder-specific projection matrices, that can be set equal and shared, similarly to the case of flat attention combination.", 
        "54": "4 Experiments  We evaluate the attention combination strategies presented in Section 3 on the tasks of multimodal translation (Section 4.1) and automatic post-editing (Section 4.2).", 
        "55": "The models were implemented using the Neural Monkey sequence-to-sequence learning toolkit (Helcl and Libovicky\u0301, 2017).12 In both setups, we process the textual input with bidirectional GRU network (Cho et al., 2014) with 300 units in the hidden state in each direction and 300 units in embeddings.", 
        "56": "For the attention projection space, we use 500 hidden units.", 
        "57": "We optimize the network to minimize the output cross-entropy using the Adam algorithm (Kingma and Ba, 2014) with learning rate 10\u22124.", 
        "58": "4.1 Multimodal Translation  The goal of multimodal translation (Specia et al., 2016) is to generate target-language image captions given both the image and its caption in the source language.", 
        "59": "We train and evaluate the model on the Multi30k dataset (Elliott et al., 2016).", 
        "60": "It consists of 29,000 training instances (images together with English captions and their German translations), 1,014 validation instances, and 1,000 test instances.", 
        "61": "The results are evaluated using the BLEU (Papineni et al., 2002) and METEOR (Denkowski and Lavie, 2011).", 
        "62": "In our model, the visual input is processed with a pre-trained VGG 16 network (Simonyan and Zisserman, 2014) without further fine-tuning.", 
        "63": "Atten-\n1http://github.com/ufal/neuralmonkey 2The trained models can be downloaded from\nhttp://ufallab.ms.mff.cuni.cz/ \u02dclibovicky/acl2017_att_models/\ntion distribution over the visual input is computed from the last convolutional layer of the network.", 
        "64": "The decoder is an RNN with 500 conditional GRU units (Firat and Cho, 2016) in the recurrent layer.", 
        "65": "We use byte-pair encoding (Sennrich et al., 2016b) with a vocabulary of 20,000 subword units shared between the textual encoder and the decoder.", 
        "66": "The results of our experiments in multimodal MT are shown in Table 1.", 
        "67": "We achieved the best results using the hierarchical attention combination without the sentinel mechanism, which also showed the fastest convergence.", 
        "68": "The flat combination strategy achieves similar results eventually.", 
        "69": "Sharing the projections for energy and context vector computation does not improve over the concatenation baseline and slows the training almost prohibitively.", 
        "70": "Multimodal models were not able to surpass the textual baseline (BLEU 33.0).", 
        "71": "Using the conditional GRU units brought an improvement of about 1.5 BLEU points on average, with the exception of the concatenation scenario where the performance dropped by almost 5 BLEU points.", 
        "72": "We hypothesize this is caused by the fact the model has to learn the implicit attention combination on multiple places \u2013 once in the output projection and three times inside the conditional GRU unit (Firat and Cho, 2016, Equations 10-12).", 
        "73": "We thus report the scores of the introduced attention combination techniques trained with conditional GRU units and compare them with the concatenation baseline trained with plain GRU units.", 
        "74": "4.2 Automatic MT Post-editing  Automatic post-editing is a task of improving an automatically generated translation given the source sentence where the translation system is treated as a black box.", 
        "75": "We used the data from the WMT16 APE Task (Bojar et al., 2016; Turchi et al., 2016), which consists of 12,000 training, 2,000 validation, and 1,000 test sentence triplets from the IT domain.", 
        "76": "Each triplet contains an English source sentence, an automatically generated German translation of the source sentence, and a manually post-edited German sentence as a reference.", 
        "77": "In case of this dataset, the MT outputs are almost perfect in and only little effort was required to post-edit the sentences.", 
        "78": "The results are evaluated using the humantargeted error rate (HTER) (Snover et al., 2006) and BLEU score (Papineni et al., 2002).", 
        "79": "Following Libovicky\u0301 et al.", 
        "80": "(2016), we encode the target sentence as a sequence of edit operations transforming the MT output into the reference.", 
        "81": "By this technique, we prevent the model from paraphrasing the input sentences.", 
        "82": "The decoder is a GRU network with 300 hidden units.", 
        "83": "Unlike in the MMT setup (Section 4.1), we do not use the conditional GRU because it is prone to overfitting on the small dataset we work with.", 
        "84": "The models were able to slightly, but significantly improve over the baseline \u2013 leaving the MT output as is (HTER 24.8).", 
        "85": "The differences between the attention combination strategies are not significant.", 
        "86": "5 Related Work  Attempts to use S2S models for APE are relatively rare (Bojar et al., 2016).", 
        "87": "Niehues et al.", 
        "88": "(2016) concatenate both inputs into one long sequence, which forces the encoder to be able to work with both source and target language.", 
        "89": "Their attention is then similar to our flat combination strategy; however, it can only be used for sequential data.", 
        "90": "The best system from the WMT\u201916 competition (Junczys-Dowmunt and Grundkiewicz, 2016) trains two separate S2S models, one translating from MT output to post-edited targets and the second one from source sentences to post-edited targets.", 
        "91": "The decoders average their output distributions similarly to decoder ensembling.", 
        "92": "The biggest source of improvement in this state-of-theart posteditor came from additional training data generation, rather than from changes in the network architecture.", 
        "93": "Source: a man sleeping in a green room on a couch .", 
        "94": "Reference: ein Mann schla\u0308ft in einem gru\u0308nen Raum auf einem Sofa .", 
        "95": "Output with attention:\nCaglayan et al.", 
        "96": "(2016) used an architecture very similar to ours for multimodal translation.", 
        "97": "They made a strong assumption that the network can be trained in such a way that the hidden states of the encoder and the convolutional network occupy the same vector space and thus sum the context vectors from both modalities.", 
        "98": "In this way, their multimodal MT system (BLEU 27.82) remained far bellow the text-only setup (BLEU 32.50).", 
        "99": "New state-of-the-art results on the Multi30k dataset were achieved very recently by Calixto et al.", 
        "100": "(2017).", 
        "101": "The best-performing architecture uses the last fully-connected layer of VGG-19 network (Simonyan and Zisserman, 2014) as decoder initialization and only attends to the text encoder hidden states.", 
        "102": "With a stronger monomodal baseline (BLEU 33.7), their multimodal model achieved a BLEU score of 37.1.", 
        "103": "Similarly to Niehues et al.", 
        "104": "(2016) in the APE task, even further improvement was achieved by synthetically extending the dataset.", 
        "105": "6 Conclusions  We introduced two new strategies of combining attention in a multi-source sequence-to-sequence setup.", 
        "106": "Both methods are based on computing a joint distribution over hidden states of all encoders.", 
        "107": "We conducted experiments with the proposed strategies on multimodal translation and automatic post-editing tasks, and we showed that the flat and hierarchical attention combination can be applied to these tasks with maintaining competitive score to previously used techniques.", 
        "108": "Unlike the simple context vector concatenation, the introduced combination strategies can be used with the conditional GRU units in the decoder.", 
        "109": "On top of that, the hierarchical combination strategy exhibits faster learning than than the other strategies.", 
        "110": "Acknowledgments  We would like to thank Ondr\u030cej Dus\u030cek, Rudolf Rosa, Pavel Pecina, and Ondr\u030cej Bojar for a fruitful discussions and comments on the draft of the paper.", 
        "111": "This research has been funded by the Czech Science Foundation grant no.", 
        "112": "P103/12/G084, the EU grant no.", 
        "113": "H2020-ICT-2014-1-645452 (QT21), and Charles University grant no.", 
        "114": "52315/2014 and SVV project no.", 
        "115": "260 453.", 
        "116": "This work has been using language resources developed and/or stored and/or distributed by the LINDAT-Clarin project of the Ministry of Education of the Czech Republic (project LM2010013)."
    }, 
    "document_id": "P17-2031.pdf.json"
}
